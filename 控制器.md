1. # 理解控制器


在Angular中,控制器是由JavaScript构造函数定义的,参数是域\(scope\).

当一个控制器通过`ng-controller`指令附加到DOM元素时,Angular将会实例化一个新的控制器对象,使用指定的控制器构造函数.一个新的子作用域会被创建并成为一个可注入的参数,名称为`$scope`.

如果控制器通过使用`controller as`语法附加到DOM元素时,控制器的实例将被复制到新作用域的一个属性上.

使用控制器:

* 设置`$scope`对象的初始状态
* 为`$scope`对象增加行为

不要使用控制器:

* 操作DOM--控制器应该只包含业务逻辑.增加任何显示逻辑到控制器上会显著影响控制器的可测试性.Angular拥有数据绑定和指令去封装DOM操作.
* 格式化输入--应该使用Angular表单控制.
* 过滤输出--使用过滤器代替.
* 通过控制器共享代码和状态--使用Angular的自定义服务代替.
* 管理其他组件的生命周期\(例如创建服务的实例\)

---

## 设置`$scope`对象的初始状态

当你创建一个应用程序时,你需要为你的`$scope`对象设置初始状态.你可以通过给`$scope`添加新的属性去设置初始状态.这些属性包含了**view model**\(模型会通过视图显示出来\).所有的`$scope`属性可以在控制器注册的DOM元素和子元素上使用.

接下来的例子展示了创建一个`GreetingController`控制器,并添加了一个值为`Hola!`的`greeting`属性到`$scope`:

```
var myApp = angular.module('myApp',[]);

myApp.controller('GreetingController', ['$scope', function($scope) {
  $scope.greeting = 'Hola!';
}]);
```

我们为我们的程序创建了一个Angular模块`myApp`.然后我们使用`.controller()`方法将控制器的构造函数添加到模块上.使得控制器的构造函数没有暴露在全局作用域.

> 我们使用**内联的注入注解**去显示的指定控制器对由Angular提供的`$scope`服务的依赖.查看依赖注入章节获得更多的信息.

我们通过使用`ng-controller`指令将控制器附加到DOM元素上.`greeting`属性能被数据绑定到模板上.
```
<div ng-controller="GreetingController">
  {{ greeting }}
</div>
```
