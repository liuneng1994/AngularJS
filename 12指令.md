# 创建自定义指令

这个文档解释了什么时候需要创建自定义指令和如果去实现它们.

## 什么是指令

站在一个高的层面上看,指令是在DOM元素上的标记\(如属性,元素名,注释或者CSS类\),通知AngularJS的**HTML编译器**\(`$compile`\)去给DOM元素添加一些指定的行为\(如通过事件监听器\),或者改变DOM元素和它的子元素.

Angular实现了一系列的内建指令,像`ngBind`,`ngModel`和`ngClass`.就像你可以创建控制器,服务一样,你也可以创建你自己的指令.在Angular启动你的应用程序的时候,HTML编译器会遍历DOM并且匹配DOM元素上的指令.

> **编译一个HTML模板的含义是什么**:对于AngularJS而言,"编译"的意思是添加指令到HTML上,使其具有交互性.使用编译这个术语的原因是,在编译语言中会编译处理源码并递归地处理附加的指令镜像.

## 匹配指令

在能够实现自己的指令之前,我们需要知道Angular的HTML编译器是如何决定什么时候去使用一个给定的指令.

与元素匹配一个选择器一样,我们将指令是元素声明的一部分定义为一个元素匹配了一个指令.

在接下来的例子中,我们说这个`<input>`元素匹配了`ngModel`指令.

```html
<input ng-model="foo">
```

下面的`<input>`元素也匹配了`ngModel`:

```html
<input data-ng-model="foo">
```

下面的元素匹配了`person`指令:

```html
<person>{{name}}</person>
```

### 标准化

Angular将一个元素的标签和属性名标准化,以此决定元素匹配哪些指令.我们更喜欢使用以大小写敏感的驼峰规则作为指令的标准名称\(如`ngModel`\).然而,因为HTML是大小写不敏感的,我们通常在DOM中使用小写的格式,以横杠`-`分隔属性\(如`ng-model`\).

标准化的处理有以下规则:

1. 跳过元素和属性的`X-`和`data-`前缀.
2. 转换`:`,`-`或者`_`分隔的名称成驼峰规则.  

例如,下面的表单中的元素都可以匹配到`ngBind`指令:
**index.html**

```html
<div ng-controller="Controller">
  Hello <input ng-model='name'> <hr/>
  <span ng-bind="name"></span> <br/>
  <span ng:bind="name"></span> <br/>
  <span ng_bind="name"></span> <br/>
  <span data-ng-bind="name"></span> <br/>
  <span x-ng-bind="name"></span> <br/>
</div>
```

**script.js**

```js
angular.module('docsBindExample', [])
.controller('Controller', ['$scope', function($scope) {
  $scope.name = 'Max Karl Ernst Ludwig Planck (April 23, 1858 – October 4, 1947)';
}]);
```

> 最佳实践:推荐使用`-`分隔的格式\(如`ngBind`写成`ng-bind`\).如果你想要使用一个HTML验证工具,你可以带有`data-`前缀的版本\(如`ngBind`写成`data-ng-bind`\).其他因为历史原因的格式可以被接受,但是建议避免去使用.

###指令类型

`$compile`可以匹配在元素名,属性,类名和注释中的指令.

所有Angular提供的指令都能够用于属性名,标签名,注释或者类名.下面的例子演示了在同一个模板中使用不同的方式引用指令.
```html

```